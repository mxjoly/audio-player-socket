(()=>{"use strict";var e={"./src/client/index.tsx":(e,r,t)=>{var n=t("./node_modules/react/index.js"),a=t("./node_modules/react-dom/index.js"),o=t("./node_modules/react-router-dom/esm/react-router-dom.js"),i=t("./node_modules/react-helmet-async/lib/index.module.js"),l=t("./node_modules/axios/index.js"),c=t.n(l),u=t("./node_modules/react-icons/md/index.esm.js");const s=function Header(){return n.createElement("header",{className:"Header"},n.createElement("h1",null,n.createElement(u.FW,null),"Formation Musicale"))};function Footer(){return n.createElement("footer",{className:"Footer"},n.createElement("p",{className:"Footer__Text"},"D\xe9velop\xe9 par"," ",n.createElement("a",{className:"Footer__Author",href:"https://github.com/mxjoly",target:"_blank"},"Maxime Joly")))}Footer.propTypes={};const d=Footer;var _=t("./node_modules/prop-types/index.js"),m=t.n(_),p=t("./node_modules/react-slider/es/components/ReactSlider/ReactSlider.js"),f=function ProgressBar(e){var r=e.value,t=e.maxValue,a=e.onValueChange,o=e.displayProgress,i=0;function onSelectValue(e){a&&a(e)}return t>0&&r>0&&(i=Math.floor(100*r/t)),n.createElement("div",{className:"ProgressBar"},o&&n.createElement("span",{className:"ProgressBar__Value"},"".concat(i,"%")),n.createElement(p.Z,{className:"ProgressBar__Slider",min:1,max:t,orientation:"horizontal",value:r,step:1,trackClassName:"ProgressBar__Slider__Track",thumbClassName:"ProgressBar__Slider__Thumb",onChange:onSelectValue,onSliderClick:onSelectValue}))};f.propTypes={value:m().number.isRequired,maxValue:m().number,displayProgress:m().bool,onValueChange:m().func},f.defaultProps={maxValue:100};const y=f;var h=t("./node_modules/react-icons/lib/esm/index.js");function Track(e){return n.createElement("div",{className:["Track",e.selected&&"Track_selected"].filter(Boolean).join(" "),onClick:function onClick(){return e.onSelect(e.id)}},n.createElement("div",{className:"Track__Panel"},n.createElement(h.Pd.Provider,{value:{className:"Track__Button"}},e.played?n.createElement(u.hPq,null):n.createElement(u.Nhx,null)),n.createElement("div",{className:"Track__Title"},e.title)),n.createElement("div",{className:"Track__Duration"},function formatTime(e){var r=Math.floor(e/3600),t=Math.floor(e%3600/60),n=Math.floor(e%60);return n<10&&(n="0"+n),r?(t<10&&(t="0"+t),r+":"+t+":"+n):t+":"+n}(e.duration)))}Track.propTypes={id:m().oneOfType([m().string,m().number]).isRequired,title:m().string.isRequired,duration:m().number.isRequired,played:m().bool.isRequired,selected:m().bool.isRequired,onSelect:m().func.isRequired};const b=Track;function TrackList(e){function onSelectTrack(r){var t=e.tracks.find((function(e){return e.id===r}));t&&e.onSelect(t)}return n.createElement("ul",{className:"TrackList"},e.tracks.length>0&&e.tracks.map((function(r){var t,a;return n.createElement("li",{key:r.id},n.createElement(b,{id:r.id,title:r.title,duration:r.duration,played:r.id===(null===(t=e.selected)||void 0===t?void 0:t.id)&&e.played,selected:r.id===(null===(a=e.selected)||void 0===a?void 0:a.id),onSelect:onSelectTrack}))})))}TrackList.propTypes={tracks:m().arrayOf(m().shape({id:m().oneOfType([m().string,m().number]).isRequired,title:m().string.isRequired,duration:m().number.isRequired,url:m().string.isRequired}).isRequired).isRequired,onSelect:m().func.isRequired,played:m().bool.isRequired,selected:m().shape({id:m().oneOfType([m().string,m().number]).isRequired,title:m().string.isRequired,duration:m().number.isRequired,url:m().string.isRequired})},TrackList.defaultProps={list:[]};const k=TrackList;function _slicedToArray(e,r){return function _arrayWithHoles(e){if(Array.isArray(e))return e}(e)||function _iterableToArrayLimit(e,r){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var t=[],n=!0,a=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(n=(i=l.next()).done)&&(t.push(i.value),!r||t.length!==r);n=!0);}catch(c){a=!0,o=c}finally{try{n||null==l.return||l.return()}finally{if(a)throw o}}return t}(e,r)||function _unsupportedIterableToArray(e,r){if(!e)return;if("string"===typeof e)return _arrayLikeToArray(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return _arrayLikeToArray(e,r)}(e,r)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}var v="/assets/musics/",T=window.location.search.includes("?admin=true");function MediaPlayer(e){var r=_slicedToArray((0,n.useState)([]),2),t=r[0],a=r[1],o=_slicedToArray((0,n.useState)(0),2),i=o[0],l=o[1],c=_slicedToArray((0,n.useState)(null),2),u=c[0],s=c[1],d=_slicedToArray((0,n.useState)(null),2),_=d[0],m=d[1],p=_slicedToArray((0,n.useState)(!1),2),f=p[0],h=p[1],b=_slicedToArray((0,n.useState)(!1),2),g=b[0],A=b[1];function createAudio(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,t=new Audio(e);return t.currentTime=r,t.preload="auto",t.ontimeupdate=function(){l(t.currentTime)},t.onended=function(){h(!1),m(createAudio(e)),l(0)},t}function startNewAudio(r){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;f&&stopAudio();var n=createAudio(r.url,t);n.load(),n.play(),h(!0),m(n),s(r),T&&e.socket.emit("play",{id:r.id,time:t})}function stopAudio(){_&&(_.pause(),_.currentTime=0)}function onSelectTrack(r){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(u&&_&&u.id===r.id)f?(_.pause(),h(!1),T&&e.socket.emit("pause",{id:u.id,time:_.currentTime})):(_.play(),h(!0),T&&e.socket.emit("play",{id:u.id,time:_.currentTime}));else if(u&&_&&u.id!==r.id){var a=t.find((function(e){return e.id===r.id}));a?(f&&(stopAudio(),h(!1)),startNewAudio(a,n)):console.warn("The sync track cannot be loaded")}else if(!u&&!_){var o=t.find((function(e){return e.id===r.id}));o?startNewAudio(o,n):console.warn("The sync track cannot be loaded")}}function formatTime(e){var r=Math.floor(e/3600),t=Math.floor(e%3600/60),n=Math.floor(e%60);return n<10&&(n="0"+n),r?(t<10&&(t="0"+t),r+":"+t+":"+n):t+":"+n}return(0,n.useEffect)((function(){!function loadTracks(e){var r=e.map((function(e){return v+e})).map((function(e){return new Audio(e)})),t=[],n=[];r.forEach((function(r,a){n.push(new Promise((function(n){r.onloadedmetadata=function(){var o=e[a].lastIndexOf("."),i=r.title||e[a].slice(0,o),l=Math.floor(r.duration);t.push({id:a,title:i,duration:l,url:r.src}),n()}})))})),Promise.all(n).then((function(){a(t)}))}(e.sources),A(!0)}),[]),T||((0,n.useEffect)((function(){function handlePlay(e){var r=e.id,n=e.time,a=t.find((function(e){return e.id===r}));a?onSelectTrack(a,n):console.warn("The sync track cannot be loaded")}return e.socket.on("play",handlePlay),function(){e.socket.off("play",handlePlay)}}),[g,t,_,u,e.socket]),(0,n.useEffect)((function(){function handlePause(e){e.id,e.time;_&&f&&(stopAudio(),h(!1))}return e.socket.on("pause",handlePause),function(){e.socket.off("pause",handlePause)}}),[_,f,e.socket]),(0,n.useEffect)((function(){function handleChange(e){e.id;var r=e.time,t=e.played;_&&(_.currentTime=r,l(r),f!==t&&(f&&stopAudio(),h(t)))}return e.socket.on("change",handleChange),function(){e.socket.off("change",handleChange)}}),[_,f,e.socket])),g?n.createElement("div",{className:"MediaPlayer"},n.createElement("div",{className:"MediaPlayer__Content"},n.createElement("div",{className:"MediaPlayer__Track"},n.createElement("div",{className:"MediaPlayer__Track__Timer"},formatTime(i)),n.createElement("div",{className:"MediaPlayer__Track__Title"},(null===u||void 0===u?void 0:u.title)||""),n.createElement("div",{className:"MediaPlayer__Track__Duration"},u?formatTime(u.duration):"--")),n.createElement(y,{value:i,maxValue:_?_.duration:100,onValueChange:function onTimeChange(r){_&&u&&isFinite(r)&&(_.currentTime=r,l(r),T&&e.socket.emit("change",{id:u.id,time:_.currentTime,played:f}))}}),n.createElement(k,{tracks:t,onSelect:onSelectTrack,played:f,selected:u}))):n.createElement("div",null)}MediaPlayer.propTypes={sources:m().arrayOf(m().string.isRequired).isRequired,socket:m().any.isRequired};const g=MediaPlayer;function App_slicedToArray(e,r){return function App_arrayWithHoles(e){if(Array.isArray(e))return e}(e)||function App_iterableToArrayLimit(e,r){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var t=[],n=!0,a=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(n=(i=l.next()).done)&&(t.push(i.value),!r||t.length!==r);n=!0);}catch(c){a=!0,o=c}finally{try{n||null==l.return||l.return()}finally{if(a)throw o}}return t}(e,r)||function App_unsupportedIterableToArray(e,r){if(!e)return;if("string"===typeof e)return App_arrayLikeToArray(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return App_arrayLikeToArray(e,r)}(e,r)||function App_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function App_arrayLikeToArray(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}var A=t("./node_modules/socket.io-client/build/index.js");const w=function App(){var e=App_slicedToArray((0,n.useState)(null),2),r=e[0],t=e[1],a=App_slicedToArray((0,n.useState)([]),2),o=a[0],l=a[1];return(0,n.useEffect)((function(){var e=A("http://localhost:8500");return e.on("connection",(function(){console.log("Connected to the server")})),c()({method:"get",url:"".concat("http://localhost:8500","/api/musics")}).then((function(r){l(r.data.musics.sort()),t(e)})).catch((function(e){console.error(e)})),function(){return e.disconnect()}}),[]),r?n.createElement("div",{className:"App"},n.createElement(i.q,{defaultTitle:"Formation Musicale",titleTemplate:"%s \u2013 Media Player"},n.createElement("html",{lang:"fr-FR"}),n.createElement("link",{rel:"icon",href:"/logo.png"}),n.createElement("meta",{name:"description",content:"An application to synchronize a track with some devices."})),n.createElement(s,null),n.createElement(g,{sources:o,socket:r}),n.createElement(d,null)):n.createElement("div",null)};const E=function reportWebVitals(e){e&&e instanceof Function&&t.e(736).then(t.bind(t,"./node_modules/web-vitals/dist/web-vitals.es5.min.js")).then((function(r){var t=r.getCLS,n=r.getFID,a=r.getFCP,o=r.getLCP,i=r.getTTFB;t(e),n(e),a(e),o(e),i(e)}))};(0,a.hydrate)(n.createElement(n.StrictMode,null,n.createElement(o.VK,null,n.createElement(i.B,null,n.createElement(w,null)))),document.getElementById("app")),E()}},r={};function __webpack_require__(t){if(r[t])return r[t].exports;var n=r[t]={exports:{}};return e[t](n,n.exports,__webpack_require__),n.exports}__webpack_require__.m=e,__webpack_require__.n=e=>{var r=e&&e.__esModule?()=>e.default:()=>e;return __webpack_require__.d(r,{a:r}),r},__webpack_require__.d=(e,r)=>{for(var t in r)__webpack_require__.o(r,t)&&!__webpack_require__.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:r[t]})},__webpack_require__.e=()=>Promise.resolve(),__webpack_require__.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),__webpack_require__.o=(e,r)=>Object.prototype.hasOwnProperty.call(e,r),__webpack_require__.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e={296:0},r=[["./src/client/index.tsx",736],["./node_modules/core-js/stable/index.js",736],["./node_modules/regenerator-runtime/runtime.js",736]],checkDeferredModules=()=>{};function checkDeferredModulesImpl(){for(var t,n=0;n<r.length;n++){for(var a=r[n],o=!0,i=1;i<a.length;i++){var l=a[i];0!==e[l]&&(o=!1)}o&&(r.splice(n--,1),t=__webpack_require__(__webpack_require__.s=a[0]))}return 0===r.length&&(__webpack_require__.x(),__webpack_require__.x=()=>{}),t}__webpack_require__.x=()=>{__webpack_require__.x=()=>{},t=t.slice();for(var e=0;e<t.length;e++)webpackJsonpCallback(t[e]);return(checkDeferredModules=checkDeferredModulesImpl)()};var webpackJsonpCallback=t=>{for(var a,o,[i,l,c,u]=t,s=0,d=[];s<i.length;s++)o=i[s],__webpack_require__.o(e,o)&&e[o]&&d.push(e[o][0]),e[o]=0;for(a in l)__webpack_require__.o(l,a)&&(__webpack_require__.m[a]=l[a]);for(c&&c(__webpack_require__),n(t);d.length;)d.shift()();return u&&r.push.apply(r,u),checkDeferredModules()},t=self.webpackChunkmusic_player_sync=self.webpackChunkmusic_player_sync||[],n=t.push.bind(t);t.push=webpackJsonpCallback})(),__webpack_require__.x()})();